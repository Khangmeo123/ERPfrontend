<div class="page goods-receipt-po">

  <div class="page-header justify-content-between">
    <div class="justify-content-start align-items-center">
        <span (click)="backToList()" class="back-to-list">
            <i class="material-icons">arrow_back_ios</i>
        </span>
      <span class="page-title">
          {{pageTitle | translate}}
      </span>
      <span class="ml-2 pending-receive-status">{{'general.pendingReceive'| translate}}</span>
    </div>

    <div class="page-actions d-flex">
      <button (click)="receive()" class="btn btn-labeled btn-receive" data-qe-id="button-receive">
        <span class="btn-label"><i class="material-icons">assignment_returned</i></span>
        <span class="button-label">
            {{'general.button.receive' | translate}}
        </span>
      </button>
      <button (click)="rejectReceive()" class="btn btn-labeled btn-rejected" data-qe-id="button-rejected">
        <span class="btn-label"><i class="material-icons">block</i></span>
        <span class="button-label">
            {{'general.button.rejected' | translate}}
        </span>
      </button>
      <div class="btn-group btn-labeled" data-qe-id="button-action" dropdown>
        <button aria-controls="dropdown-basic" class="btn btn-labeled btn-import" dropdownToggle id="button-basic">
          <span class="btn-label"><i class="material-icons">arrow_drop_down</i></span>
          <span class="button-label">
              {{'general.action' | translate}}
          </span></button>
        <ul *dropdownMenu aria-labelledby="button-basic" class="dropdown-menu dropdown-menu-right" id="dropdown-basic"
            role="menu">
          <li role="menuitem">
            <a class="dropdown-item btn btn-link" role="button">{{'general.button.history' | translate}}</a>
          </li>
          <li class="divider dropdown-divider"></li>
          <li role="menuitem">
            <a class="dropdown-item btn btn-link" role="button">{{'general.button.print' | translate}}</a>
          </li>
          <li class="divider dropdown-divider"></li>
          <li role="menuitem">
            <a class="dropdown-item btn btn-link" role="button">{{'general.button.referenceDocument' | translate}}</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <div [formGroup]="goodsReceiptPOForm" class="page-body">
    <div class="page-section">
      <div class="page-section-form-header">
        <span class="form-title">
            {{'goodsReceiptPODetail.form.title' | translate}}
        </span>
        <div class="page-actions justify-content-end">
        </div>
      </div>
      <div class="line"></div>
      <div class="page-section-form-body">
        <div class="row">
          <div class="col-sm-4 form-group">
            <label for="detail-form-supplierCode">
              {{'goodsReceiptPODetail.supplierCode' | translate}}
              <span class="text-danger mr-2">*</span>
            </label>
            <input class="form-control disabled"
                   data-qe-id="detail-form-supplierCode"
                   id="detail-form-supplierCode"
                   formControlName="supplierCode"
                   type="text"/>
          </div>
          <div class="col-sm-4 form-group">
            <label for="detail-form-supplierName">
              {{'goodsReceiptPODetail.supplierName' | translate}}
            </label>
            <input class="form-control disabled"
                   data-qe-id="detail-form-supplierName"
                   id="detail-form-supplierName"
                   formControlName="supplierName"
                   type="text">
          </div>
          <div class="col-sm-4 form-group">
            <label for="detail-form-supplierAddress">
              {{'goodsReceiptPODetail.supplierAddress' | translate}}
            </label>
            <input class="form-control disabled"
                   data-qe-id="detail-form-supplierAddress"
                   id="detail-form-supplierAddress"
                   formControlName="supplierAddress"
                   type="text"/>
          </div>
        </div>
      </div>
      <div class="line"></div>
      <div class="page-section-form-body">
        <div class="row">
          <div class="col-sm-8 form-group">
            <label for="detail-form-purchaseOrderName">
              {{'goodsReceiptPODetail.goodsReceipt.title' | translate}}
              <span class="text-danger mr-2">*</span>
            </label>
            <input class="form-control disabled"
                   data-qe-id="detail-form-purchaseOrderName"
                   id="detail-form-purchaseOrderName"
                   formControlName="purchaseOrderName"
                   type="text">
          </div>
        </div>
      </div>
      <div class="line"></div>
      <div class="page-section-form-body">
        <div class="row">
          <div class="col-sm-4 form-group">
            <label for="detail-form-documentNumber">
              {{'goodsReceiptPODetail.documentNumber' | translate}}
              <span class="text-danger mr-2">*</span>
            </label>
            <input class="form-control disabled"
                   data-qe-id="detail-form-documentNumber"
                   id="detail-form-documentNumber"
                   formControlName="documentNumber"
                   type="text">
          </div>
          <div class="col-sm-4 form-group">
            <label for="detail-form-inventoryOrganizationCode">
              {{'goodsReceiptPODetail.inventoryCode' | translate}}
            </label>
            <input class="form-control disabled"
                   data-qe-id="detail-form-inventoryOrganizationCode"
                   id="detail-form-inventoryOrganizationCode"
                   formControlName="inventoryOrganizationCode"
                   type="text">
          </div>
          <div class="col-sm-4 form-group">
            <label for="detail-form-inventoryOrganizationStreet">
              {{'goodsReceiptPODetail.inventoryAddress' | translate}}
            </label>
            <input class="form-control disabled"
                   data-qe-id="detail-form-inventoryOrganizationStreet"
                   id="detail-form-inventoryOrganizationStreet"
                   formControlName="inventoryOrganizationStreet"
                   type="text">
          </div>
        </div>
        <div class="row">
          <div class="col-sm-4 form-group">
            <label for="detail-form-ownerName">
              {{'goodsReceiptPODetail.personInCharge' | translate}}
              <span class="text-danger mr-2">*</span>
            </label>
            <input class="form-control disabled"
                   data-qe-id="detail-form-ownerName"
                   id="detail-form-ownerName"
                   formControlName="ownerName"
                   type="text">
          </div>
          <div class="col-sm-4 form-group">
            <label for="detail-form-buyerName">
              {{'goodsReceiptPODetail.receiver' | translate}}
            </label>
            <input class="form-control disabled"
                   data-qe-id="detail-form-buyerName"
                   id="detail-form-buyerName"
                   formControlName="buyerName"
                   type="text">
          </div>
          <div class="col-sm-4 form-group">
            <label for="detail-form-creator">
              {{'goodsReceiptPODetail.creator' | translate}}
            </label>
            <input class="form-control disabled"
                   data-qe-id="detail-form-creator"
                   id="detail-form-creator"
                   formControlName="requesterName"
                   type="text">
          </div>
        </div>
        <div class="row">

          <div class="col-sm-4 form-group">
            <label for="due-date">
              {{'goodsReceiptPODetail.receiptedDate' | translate}}
              <span class="text-danger mr-2">*</span>
            </label>
            <app-date-picker [control]="dueDate"
                             id="due-date"
                             [disabled]="true" data-qe-id="detail-form-receipted-date">
            </app-date-picker>
          </div>
          <div class="col-sm-4 form-group">
            <label for="document-date">
              {{'goodsReceiptPODetail.createdDate' | translate}}
            </label>
            <app-date-picker [control]="documentDate"
                             id="document-date"
                             [disabled]="true" data-qe-id="detail-form-created-date">
            </app-date-picker>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12 form-group">
            <label for="detail-form-remarks">{{ 'goodsReceiptPODetail.description' | translate}}</label>
            <textarea class="form-control disabled"
                      data-qe-id="detail-form-remarks"
                      id="detail-form-remarks"
                      formControlName="remarks"
                      rows="4">
                        </textarea>
          </div>
        </div>
      </div>
    </div>
    <div class="page-section">
      <div class="tab-header pt-3 pb-3 pl-3 pr-3">
        <mat-tab-group>
          <mat-tab label="{{'goodsReceiptPODetail.tab1.title' | translate}}">
            <div class="table mt-3" formArrayName="goodsReceiptPOContents">
              <p-table #goodsReceiptPOContentsTable [resizableColumns]="true" [rowTrackBy]="trackByFn"
                       [scrollable]="true" [value]="goodsReceiptPOForm.controls.goodsReceiptPOContents.value"
                       scrollHeight="500px">
                <ng-template pTemplate="colgroup">
                  <colgroup>
                    <col>
                    <col>
                    <col>
                    <col>
                    <col>
                    <col>
                    <col>
                  </colgroup>
                </ng-template>
                <ng-template pTemplate="header">
                  <tr>
                    <th data-qe-id="table-thead-purchase-order-number" pResizableColumn>
                      {{'goodsReceiptPODetail.tab1.purchaseOrderNumber' | translate}}
                    </th>
                    <th data-qe-id="table-thead-item-no" pResizableColumn>
                      {{'goodsReceiptPODetail.tab1.itemNo' | translate}}
                    </th>
                    <th data-qe-id="table-thead-purchase-order-number" pResizableColumn>
                      {{'goodsReceiptPODetail.tab1.itemName' | translate}}
                    </th>
                    <th data-qe-id="table-thead-unit-of-measure" pResizableColumn>
                      {{'goodsReceiptPODetail.tab1.unitOfMeasure' | translate}}
                    </th>
                    <th data-qe-id="table-thead-quantity" pResizableColumn>
                      {{'goodsReceiptPODetail.tab1.quantity' | translate}}
                    </th>
                    <th data-qe-id="table-thead-actualReceive" pResizableColumn>
                      {{'goodsReceiptPODetail.tab1.actualReceive' | translate}}
                    </th>
                    <th data-qe-id="table-thead-view-detail" pResizableColumn>
                      {{'general.detail' | translate}}
                    </th>
                  </tr>
                  <tr>
                    <th class="th-filter">
                      <jaja-select-list [getList]="goodsReceiptPOReceiveRepository.getDocumentNumberList"
                                        [searchEntity]="documentNumberSearchEntity"
                                        searchField="documentNumber"
                                        [searchable]="true"
                                        appendTo="body"
                                        [small]="true"
                                        placeholder="{{'goodsReceiptPODetail.tab1.purchaseOrderNumber' | translate}}">
                        <ng-template #label #option let-documentNumber="documentNumber">
                          {{documentNumber}}
                        </ng-template>
                      </jaja-select-list>

                    </th>
                    <th class="th-filter">
                      <jaja-select-list [getList]="goodsReceiptPOReceiveRepository.getItemDetailList"
                                        [searchEntity]="itemDetailSearchEntity"
                                        [searchable]="true"
                                        searchField="code"
                                        [small]="true"
                                        appendTo="body"
                                        placeholder="{{'goodsReceiptPODetail.tab1.itemNo' | translate}}">
                        <ng-template #label #option let-code="code">
                          {{code}}
                        </ng-template>
                      </jaja-select-list>
                    </th>
                    <th class="th-filter">
                      <input (input)="goodsReceiptPOContentsTable.filter($event.target.value, 'itemName', 'contains')"
                             class="form-control w-100"
                             type="text"/>
                    </th>
                    <th class="th-filter">
                      <jaja-select-list [getList]="goodsReceiptPOReceiveRepository.getUnitOfMeasureList"
                                        [searchEntity]="unitOfMeasureSearchEntity"
                                        searchField="code"
                                        [searchable]="true"
                                        [small]="true"
                                        appendTo="body">
                        <ng-template #label #option let-code="code">
                          {{code}}
                        </ng-template>
                      </jaja-select-list>
                    </th>
                    <th class="th-filter"></th>
                    <th class="th-filter"></th>
                    <th class="th-filter"></th>
                  </tr>
                </ng-template>
                <ng-template let-goodsReceiptPOContent let-index="rowIndex" pTemplate="body">
                  <tr [formGroupName]='index'>
                    <td class="ui-resizable-column">{{goodsReceiptPOContent.documentNumber}}</td>
                    <td class="ui-resizable-column">{{goodsReceiptPOContent.itemCode}}</td>
                    <td class="ui-resizable-column">{{goodsReceiptPOContent.itemName}}</td>
                    <td class="ui-resizable-column">{{goodsReceiptPOContent.unitOfMeasureName}}</td>
                    <td class="ui-resizable-column">{{goodsReceiptPOContent.quantity}}</td>
                    <td class="ui-resizable-column">{{goodsReceiptPOContent.actualReceive}}</td>
                    <td>
                      <a (click)="showBatch(goodsReceiptPOContent)" role="button" class="btn btn-link">
                        {{'goodsReceiptPODetail.tab1.batches' | translate}}
                      </a>
                      <a (click)="showSerial(goodsReceiptPOContent)" role="button" class="btn btn-link">
                        {{'goodsReceiptPODetail.tab1.Serial' | translate}}
                      </a>
                      <a (click)="showQuantity(goodsReceiptPOContent)" role="button" class="btn btn-link">
                        {{'goodsReceiptPODetail.tab1.amount' | translate}}
                      </a>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </mat-tab>
          <mat-tab label="{{'goodsReceiptPODetail.tab2.title' | translate}}">
            <div class="tab-upload mt-4">
              <div class="row">
                <div class="col">
                  <nz-upload [nzDisabled]="true"
                             [nzLimit]="0"
                             [nzMultiple]="true"
                             nzType="drag">
                    <p class="ant-upload-drag-icon">
                      <i nz-icon nzType="upload"></i>
                    </p>
                    <p class="ant-upload-text">
                      {{'goodsReceiptPODetail.attachments.title' | translate}}
                    </p>
                    <p class="ant-upload-hint">
                      {{'goodsReceiptPODetail.attachments.description' | translate}}
                    </p>
                  </nz-upload>
                  <div class="d-flex justify-content-start mt-2">
                    <button disabled class="btn btn-labeled btn-send mr-2">
                    <span class="btn-label">
                      <i class="material-icons">cloud_upload</i>
                    </span>
                      <span class="button-label">
                      {{'general.button.upload' | translate}}
                    </span>
                    </button>

                    <button (click)="toggleAttachmentModal()" class="btn btn-labeled btn-send">
                    <span class="btn-label">
                      <i class="material-icons">cloud_upload</i>
                    </span>
                      <span class="button-label">
                      {{'general.button.uploaded' | translate}} ({{fileAttachments.value.length}})
                    </span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </mat-tab>
        </mat-tab-group>
      </div>
    </div>
  </div>
</div>

<app-batch-dialog [batch]="batch"></app-batch-dialog>

<app-quantity-dialog></app-quantity-dialog>

<app-serial-dialog [serialNumberDetail]="serialNumberDetail"></app-serial-dialog>
