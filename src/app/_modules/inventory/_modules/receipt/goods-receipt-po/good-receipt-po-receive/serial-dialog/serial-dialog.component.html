<p-dialog [(visible)]="display" [contentStyle]="{'overflow':'visible'}" [modal]="true" [responsive]="true"
          [style]="{width: '90%'}" appendTo="body">
  <p-header>
    <div class="row">
      <div class="col-sm-3">
        <span class="dialog-header">{{'goodsReceiptPODetail.qrCode.title ' | translate}}</span>
      </div>
      <div class="col-sm-9">
        <div class="page-actions d-flex justify-content-end">
          <button (click)="clearSerialNumberTable(tableSerialNumber)" class="btn btn-labeled btn-clear mr-2"
                  data-qe-id="button-clear">
                        <span class="btn-label">
                            <img src="/assets/img/filter.svg" width="16">
                        </span>
            <span class="button-label">
                            {{'general.button.clear' | translate}}
                        </span>
          </button>
          <button class="btn btn-labeled btn-import mr-2">
                        <span class="btn-label">
                            <img src="/assets/img/import.svg" width="24">
                        </span>
            <span class="button-label">
                            {{'general.button.import' | translate}}
                        </span></button>
          <button class="btn btn-labeled btn-export mr-2">
            <span class="btn-label"><img src="/assets/img/export.svg" width="24"></span>
            <span class="button-label">
                {{'general.button.export' | translate}}
            </span></button>
          <button (click)="deleteMultipleSerialNumber()" class="btn btn-labeled btn-delete">
            <span class="btn-label"><i class="material-icons">delete</i></span>
            <span class="button-label">
                {{'general.button.delete' | translate}}
            </span></button>
        </div>
      </div>
    </div>
  </p-header>
  <div class="dialog-body">
    <div class="row">
      <div class="col-sm-6">
        <div class="d-flex align-items-center">
          <p-inputSwitch [(ngModel)]="activeScan"></p-inputSwitch>
          <span class="ml-2">{{'goodsReceiptPODetail.qrCode.scanQRCode' | translate}}</span>
          <div class="ml-2 col-sm-9">
            <input (change)="inputSerialNumber($event.target.value)" [(ngModel)]="serialNumber" [disabled]="!activeScan"
                   class="form-control" data-qe-id="dialog-input-start-scan-batches-no"
                   type="text">
          </div>
        </div>
      </div>
      <div class="col-sm-6">
        <div *ngIf="enableBinLocation" class="d-flex align-items-center justify-content-end">
          <span class="mr-2">{{'goodsReceiptPODetail.binLocation' | translate}}: </span>
          <jaja-select-list [getList]="serialDialogRepository.getBinLocationList"
                            [searchEntity]="binLocationSearchEntity"
                            [searchable]="true"
                            [small]="true"
                            appendTo="body"
                            placeholder=""
                            searchField="code">
            <ng-template #label #option let-code="code">
              {{code}}
            </ng-template>
          </jaja-select-list>
        </div>
      </div>
      <div class="col-sm-6 mt-2"></div>
      <div class="col-sm-6 mt-2">
        <div class="d-flex align-items-center justify-content-end">
          <span class="ml-2">{{'goodsReceiptPODetail.qrCode.quantity' | translate}}: </span>
          <div class="ml-2">
            <input [value]="quantityItems" class="form-control disabled"
                   data-qe-id="dialog-input-start-scan-batches-no"
                   type="text">
          </div>
        </div>
      </div>
      <div class="col-sm-6 mt-2"></div>
      <div class="col-sm-6 mt-2">
        <div class="d-flex align-items-center justify-content-end">
          <span class="ml-2">{{'goodsReceiptPODetail.qrCode.rows' | translate}}: </span>
          <div class="ml-2">
            <input [value]="serialNumberDetail.goodsReceiptPOSerialNumbers?.length" class="form-control disabled"
                   data-qe-id="dialog-input-start-scan-batches-no"
                   pKeyFilter="int" type="text">
          </div>
        </div>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-sm-12">
        <p-table #tableSerialNumber *ngIf="enableBinLocation" [resizableColumns]="true"
                 [scrollable]="true" [value]="serialNumberDetail.goodsReceiptPOSerialNumbers" resizableColumns
                 scrollHeight="300px">
          <ng-template pTemplate="colgroup">
            <colgroup>
              <col>
              <col>
              <col>
              <col>
              <col>
              <col>
              <col>
              <col>
              <col>
            </colgroup>
          </ng-template>
          <ng-template pTemplate="header">
            <tr>
              <th data-qe-id="table-thead-qrCode-check-box" width="2.5%">
                <div class="pretty p-icon p-curve p-has-indeterminate">
                  <input (change)="checkAllSerialNumber($event.target)" type="checkbox"/>
                  <div class="state">
                    <i class="icon material-icons">done</i>
                    <label></label>
                  </div>
                </div>
              </th>
              <th data-qe-id="table-thead-qrCode-code" pResizableColumn>
                {{'goodsReceiptPODetail.qrCode.code' | translate}} </th>
              <th data-qe-id="table-thead-qrCode-item-code" pResizableColumn>
                {{'goodsReceiptPODetail.qrCode.itemCode' | translate}} </th>
              <th data-qe-id="table-thead-qrCode-item-name" pResizableColumn>
                {{'goodsReceiptPODetail.qrCode.itemName' | translate}} </th>
              <th data-qe-id="table-thead-qrCode-serial" pResizableColumn>
                {{'goodsReceiptPODetail.qrCode.serial' | translate}} </th>
              <th data-qe-id="table-thead-qrCode-manufacturing-date" pResizableColumn>
                {{'goodsReceiptPODetail.qrCode.manufacturingDate' | translate}} </th>
              <th data-qe-id="table-thead-qrCode-expiry-date" pResizableColumn>
                {{'goodsReceiptPODetail.qrCode.expiryDate' | translate}} </th>
              <th data-qe-id="table-thead-qrCode-location-code" pResizableColumn>
                {{'goodsReceiptPODetail.qrCode.locationCode' | translate}} </th>
              <th data-qe-id="table-thead-qrCode-action" width="5%">
                {{'general.action' | translate}}
              </th>
            </tr>
            <tr>
              <th width="2.5%">
              </th>
              <th class="th-filter">
                <input (input)="tableGoodsReceiptPOContents.filter($event.target.value, 'qrCode', 'startsWith')"
                       [(ngModel)]="goodsReceiptPOContentDetailSearchEntity.qrCode" class="form-control w-100"
                       pKeyFilter="int"
                       type="text"/>
              </th>
              <th class="th-filter">
                <jaja-select-list [getList]="serialDialogRepository.getItemDetailList"
                                  [searchEntity]="itemDetailSearchEntity"
                                  [searchable]="true"
                                  [small]="true"
                                  appendTo="body"
                                  searchField="code">
                  <ng-template #label #option let-code="code">
                    {{code}}
                  </ng-template>
                </jaja-select-list>
              </th>
              <th class="th-filter">
                <input (input)="tableGoodsReceiptPOContents.filter($event.target.value, 'itemName', 'contains')"
                       [(ngModel)]="goodsReceiptPOContentDetailSearchEntity.itemName" class="form-control w-100"
                       pKeyFilter="int"
                       type="text"/>
              </th>
              <th class="th-filter">
                <input (input)="tableGoodsReceiptPOContents.filter($event.target.value, 'serialNumber', 'startsWith')"
                       [(ngModel)]="goodsReceiptPOContentDetailSearchEntity.serialNumber" class="form-control w-100"
                       pKeyFilter="int"
                       type="text"/>
              </th>
              <th class="th-filter">
                <app-date-picker (valueChange)="sortDate($event, tableSerialNumber, 'mfrDate')"
                                 data-qe-id="detail-form-receipted-date">
                </app-date-picker>
              </th>
              <th class="th-filter">
                <app-date-picker (valueChange)="sortDate($event, tableSerialNumber, 'expirationDate')"
                                 data-qe-id="detail-form-receipted-date">
                </app-date-picker>
              </th>
              <th class="th-filter"></th>
              <th class="th-filter" width="5%"></th>
            </tr>
          </ng-template>
          <ng-template let-index="rowIndex" let-serialNumber pTemplate="body">
            <tr>
              <td width="2.5%">
                <div class="pretty p-icon p-curve p-has-indeterminate">
                  <input [(ngModel)]="serialNumber.isSelected" type="checkbox"/>
                  <div class="state">
                    <i class="icon material-icons">done</i>
                    <label></label>
                  </div>
                </div>
              </td>
              <td class="ui-resizable-column">
                {{serialNumber.qrCode}}
              </td>
              <td class="ui-resizable-column">
                {{serialNumber.itemCode}}
              </td>
              <td class="ui-resizable-column">
                {{serialNumber.itemName}}
              </td>
              <td class="ui-resizable-column">
                {{serialNumber.serialNumber}}
              </td>
              <td class="ui-resizable-column">
                {{serialNumber.mfrDate | date: 'dd/MM/yyyy'}}
              </td>
              <td class="ui-resizable-column">
                {{serialNumber.expirationDate}}
              </td>
              <td class="ui-resizable-column">
                <jaja-select-list [getList]="serialDialogRepository.getBinLocationList"
                                  [searchEntity]="binLocationSearchEntity"
                                  [searchable]="true"
                                  [small]="true"
                                  appendTo="body"
                                  searchField="code"
                                  searchType="startsWith">
                  <ng-template #label #option let-code="code">
                    {{code}}
                  </ng-template>
                </jaja-select-list>
              </td>
              <td class="text-center" width="5%">
                <mat-icon (click)="deleteSerialNumber()" class="text-danger">delete</mat-icon>
              </td>
            </tr>
          </ng-template>
        </p-table>
        <p-table #tableSerialNumber *ngIf="!enableBinLocation" [resizableColumns]="true"
                 [scrollable]="true" [value]="serialNumberDetail.goodsReceiptPOSerialNumbers" resizableColumns
                 scrollHeight="300px">
          <ng-template pTemplate="colgroup">
            <colgroup>
              <col>
              <col>
              <col>
              <col>
              <col>
              <col>
              <col>
              <col>
            </colgroup>
          </ng-template>
          <ng-template pTemplate="header">
            <tr>
              <th data-qe-id="table-thead-qrCode-check-box" width="2.5%">
                <div class="pretty p-icon p-curve p-has-indeterminate">
                  <input (change)="checkAllSerialNumber($event.target)" type="checkbox"/>
                  <div class="state">
                    <i class="icon material-icons">done</i>
                    <label></label>
                  </div>
                </div>
              </th>
              <th data-qe-id="table-thead-qrCode-code" pResizableColumn>
                {{'goodsReceiptPODetail.qrCode.code' | translate}} </th>
              <th data-qe-id="table-thead-qrCode-item-code" pResizableColumn>
                {{'goodsReceiptPODetail.qrCode.itemCode' | translate}} </th>
              <th data-qe-id="table-thead-qrCode-item-name" pResizableColumn>
                {{'goodsReceiptPODetail.qrCode.itemName' | translate}} </th>
              <th data-qe-id="table-thead-qrCode-serial" pResizableColumn>
                {{'goodsReceiptPODetail.qrCode.serial' | translate}} </th>
              <th data-qe-id="table-thead-qrCode-manufacturing-date" pResizableColumn>
                {{'goodsReceiptPODetail.qrCode.manufacturingDate' | translate}} </th>
              <th data-qe-id="table-thead-qrCode-expiry-date" pResizableColumn>
                {{'goodsReceiptPODetail.qrCode.expiryDate' | translate}} </th>
              <th data-qe-id="table-thead-qrCode-action" width="5%">
                {{'general.action' | translate}}
              </th>
            </tr>
            <tr>
              <th width="2.5%">
              </th>
              <th class="th-filter">
                <input (input)="tableGoodsReceiptPOContents.filter($event.target.value, 'qrCode', 'startsWith')"
                       class="form-control w-100" pKeyFilter="int"
                       type="text"/>
              </th>
              <th class="th-filter">
                <jaja-select-list [getList]="serialDialogRepository.getItemDetailList"
                                  [searchEntity]="itemDetailSearchEntity"
                                  [searchable]="true"
                                  searchField="code"
                                  searchType="startsWith"
                >
                </jaja-select-list>
              </th>
              <th class="th-filter">
                <input (input)="tableGoodsReceiptPOContents.filter($event.target.value, 'itemName', 'contains')"
                       class="form-control w-100" pKeyFilter="int"
                       type="text"/>
              </th>
              <th class="th-filter">
                <input (input)="tableGoodsReceiptPOContents.filter($event.target.value, 'serialNumber', 'startsWith')"
                       class="form-control w-100" pKeyFilter="int"
                       type="text"/>
              </th>
              <th class="th-filter">
                <app-date-picker (valueChange)="sortDate($event, tableSerialNumber, 'mfrDate')"
                                 data-qe-id="detail-form-receipted-date"></app-date-picker>
              </th>
              <th class="th-filter">
                <app-date-picker (valueChange)="sortDate($event, tableSerialNumber, 'expirationDate')"
                                 data-qe-id="detail-form-receipted-date">
                </app-date-picker>
              </th>
              <th class="th-filter" width="5%"></th>
            </tr>
          </ng-template>
          <ng-template let-index="rowIndex" let-serialNumber pTemplate="body">
            <tr>
              <td width="2.5%">
                <div class="pretty p-icon p-curve p-has-indeterminate">
                  <input [(ngModel)]="serialNumber.isSelected" type="checkbox"/>
                  <div class="state">
                    <i class="icon material-icons">done</i>
                    <label></label>
                  </div>
                </div>
              </td>
              <td class="ui-resizable-column">
                {{serialNumber.qrCode}}
              </td>
              <td class="ui-resizable-column">
                {{serialNumber.itemCode}}
              </td>
              <td class="ui-resizable-column">
                {{serialNumber.itemName}}
              </td>
              <td class="ui-resizable-column">
                {{serialNumber.mfrDate}}
              </td>
              <td class="ui-resizable-column">
                {{serialNumber.serialNumber}}
              </td>
              <td class="ui-resizable-column">
                {{serialNumber.expirationDate}}
              </td>
              <td class="text-center" width="5%">
                <mat-icon (click)="deleteSerialNumber()" class="text-danger">delete</mat-icon>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>
  </div>
  <p-footer>
    <div class="row">
      <div class="col-sm-12">
        <div class="page-actions d-flex justify-content-end">
          <button (click)="updateSerialNumber()" class="btn btn-labeled btn-save-dialog">
            <span class="btn-label"><i class="material-icons">save</i></span>
            <span class="button-label">
              {{'general.button.save' | translate}}
            </span></button>
          <button (click)="display = false" class="btn btn-labeled btn-cancel">
            <span class="btn-label"><i class="material-icons"> highlight_off</i></span>
            <span class="button-label">
            {{'general.button.cancel' | translate}}
          </span></button>
        </div>
      </div>
    </div>
  </p-footer>
</p-dialog>
