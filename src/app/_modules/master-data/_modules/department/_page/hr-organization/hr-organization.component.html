<div class="row">
  <div class="col-md-6">
    <div class="page">

      <div class="page-header">
        <div class="page-title">
          {{'hrOrganization.title' | translate}}
        </div>
        <div class="page-actions">
          <button class="btn btn-add" (click)="add()" [disabled]="!legalEntity || !division">
            {{'general.button.add' | translate}}
          </button>
        </div>
      </div>

      <div class="page-body mt-2">
        <div class="page-section">
          <p-table resizableColumns
                   [value]="hrOrganizationList"
                   selectionMode="single"
                   [(selection)]="selectedDepartment"
                   (selectionChange)="onSelectDepartment($event)"
                   [customSort]="true"
                   [lazy]="true"
                   (onLazyLoad)="sort($event)"
                   [scrollable]="true"
                   scrollHeight="500px"
                   [resizableColumns]="true"
                   #table>
            <ng-template pTemplate="header">
              <tr>
                <th pResizableColumn> {{'hrOrganization.code' | translate}} </th>
                <th pResizableColumn> {{'hrOrganization.name' | translate}} </th>
              </tr>
              <tr>
                <th class="th-filter">
                  <app-advanced-filters (changeFilter)="getList()"
                                        [filter]="hrOrganizationSearchEntity.code"></app-advanced-filters>
                </th>
                <th class="th-filter">
                  <app-advanced-filters (changeFilter)="getList()"
                                        [filter]="hrOrganizationSearchEntity.name"></app-advanced-filters>
                </th>
              </tr>
            </ng-template>

            <ng-template pTemplate="body" let-hrOrganization let-index let-rowData>
              <tr [pSelectableRow]="rowData" (dblclick)="edit(hrOrganization.id)"
                  [attr.data-qe-id]="'table-tbody-row-' + index">
                <td pResizableColumn>{{hrOrganization.code}}</td>
                <td pResizableColumn>{{hrOrganization.name}}</td>
              </tr>
            </ng-template>
          </p-table>
          <div class="pagination">
            <app-pagination [pagination]="pagination" (paginationOut)="onPaginationChange($event)"></app-pagination>
          </div>
        </div>
      </div>
    </div>

    <p-dialog [modal]="true" appendTo="body" [(visible)]="modal">
      <p-header>
        {{'hrOrganization.add' | translate}}
      </p-header>

      <div class="container" [formGroup]="hrOrganizationForm">
        <div class="row">
          <div class="form-group col">
            <label for="hrOrganization-code">
              {{'hrOrganization.code' | translate}}
              <span class="text-danger ml-2">*</span>
            </label>
            <div class="div-form">
              <input type="text" class="form-control" id="hrOrganization-code" formControlName="code" name="code">
              <app-error data-qe-id="hrOrganization-code"
                         *ngIf="(code?.errors && code?.touched) || !!errors.get('name')?.value"
                         [formGroup]="hrOrganizationForm" property="code" [placement]="'top'" class="error-form">
              </app-error>
            </div>
          </div>
          <div class="form-group col">
            <label for="hrOrganization-name">
              {{'hrOrganization.name' | translate}}
              <span class="text-danger ml-2">*</span>
            </label>
            <div class="div-form">
              <input type="text" class="form-control" id="hrOrganization-name" formControlName="name" name="name">
              <app-error data-qe-id="hrOrganization-name"
                         *ngIf="(name?.errors && name?.touched) || !!errors.get('name')?.value"
                         [formGroup]="hrOrganizationForm" property="name" [placement]="'top'" class="error-form">
              </app-error>
            </div>
          </div>
        </div>
      </div>

      <p-footer class="d-flex">
        <button class="btn btn-delete" *ngIf="hrOrganizationForm.value?.isDeleted">
          {{'general.button.delete' | translate}}
        </button>
        <div class="flex-grow-1">
          <button class="btn btn-add mr-2" (click)="save()">
            {{'general.button.save' | translate}}
          </button>
          <button class="btn btn-cancel mr-2">
            {{'general.button.cancel' | translate}}
          </button>
        </div>
      </p-footer>
    </p-dialog>

  </div>
  <div class="col-md-6">
    <app-employee-list [list]="employeeList" (getList)="getEmployeeList()"></app-employee-list>
  </div>
</div>
